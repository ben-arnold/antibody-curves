#-------------------------------------------#
# 2-mauke-Wb123-figure.R#
# Ben Arnold#
##
# Plot age-specific antibody curves from #
# Mauke and beeswarm plot of age-stratified#
# means#
##
# version 1 (26 mar 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot#
#-------------------------------------------#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis.pdf",width=14,height=6)#
# cols1 <- brewer.pal(8,"Set1")[c(3)]#
# cols2 <- brewer.pal(11,"Spectral")[c(11)]#
# cols <- c(cols2,cols1)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
lo <- layout(mat=matrix(1:2,nrow=1,ncol=2,byrow=TRUE),widths=c(1,1))#
# Panel A age-specific antibody curves E(Y_x,a)#
op <- par(mar=c(5,5,3,4)+0.1)#
ytics <- 2:6#
plot(mauke75$Age,mauke75$pY,type="n",#
	xlab="",xaxt="n",xlim=c(0,70),#
	ylab="",yaxt="n",ylim=range(ytics),#
	main="",#
	las=1,bty="n"#
	)#
	axis(1,at=seq(0,70,by=10),cex.axis=1.5)#
	axis(2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# abline(log(10986),0,lty=2,col="gray60")#
	set.seed(623) # jitter ages (but not actual fits) to better display the data#
	points(jitter(mauke75$Age),mauke75$Y,cex=0.45,pch=16,col=alpha(cols[1],alpha=0.6))#
	points(jitter(mauke92$Age),mauke92$Y,cex=0.45,pch=16,col=alpha(cols[2],alpha=0.6))#
	lines(mauke75$Age,mauke75$pY,col=cols[1],lwd=2)#
	lines(mauke92$Age,mauke92$pY,col=cols[2],lwd=2)#
	# Axis labels#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	mtext("Age, years",side=1,line=3,cex=1.5)#
	mtext("A",line=1,at=-10,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x][","][a]),")")),line=1,cex=1.5)#
	# Group labels#
	mtext("1975",side=4,line=0.5,adj=0,at=5.1,col=cols[1],cex=1.25,las=1)#
	mtext("1992\n(Post-MDA)",side=4,line=0.5,adj=0,at=4.7,col=cols[2],cex=1.25,las=1)#
par(op)#
#
# skinny plot of E(Y_x) for all ages (Not used)#
	# op <- par(mar=c(5,0,3,0)+0.1)#
	# plot(1,1,type="n",#
		# xlim=c(0,1),xaxt="n",xlab="",#
		# ylim=range(ytics),ylab="",yaxt="n",#
		# las=1,bty="n"#
	# )#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=1,line=1)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=0)#
	# # plot data#
	# segments(x0=0.5,y0=EYx.mauke75$lb, y1=EYx.mauke75$ub,lwd=1,col=cols[1])#
	# points(0.5,EYx.mauke75$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[1])#
	# segments(x0=0.5,y0=EYx.mauke92$lb, y1=EYx.mauke92$ub,lwd=1,col=cols[2])#
	# points(0.5,EYx.mauke92$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[2])#
# par(op)#
# dev.off()#
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=1)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 2-mauke-Wb123-figure.R#
# Ben Arnold#
##
# Plot age-specific antibody curves from #
# Mauke and beeswarm plot of age-stratified#
# means#
##
# version 1 (26 mar 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot#
#-------------------------------------------#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis.pdf",width=14,height=6)#
# cols1 <- brewer.pal(8,"Set1")[c(3)]#
# cols2 <- brewer.pal(11,"Spectral")[c(11)]#
# cols <- c(cols2,cols1)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
lo <- layout(mat=matrix(1:2,nrow=1,ncol=2,byrow=TRUE),widths=c(1,1))#
# Panel A age-specific antibody curves E(Y_x,a)#
op <- par(mar=c(5,5,3,4)+0.1)#
ytics <- 2:6#
plot(mauke75$Age,mauke75$pY,type="n",#
	xlab="",xaxt="n",xlim=c(0,70),#
	ylab="",yaxt="n",ylim=range(ytics),#
	main="",#
	las=1,bty="n"#
	)#
	axis(1,at=seq(0,70,by=10),cex.axis=1.5)#
	axis(2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# abline(log(10986),0,lty=2,col="gray60")#
	set.seed(623) # jitter ages (but not actual fits) to better display the data#
	points(jitter(mauke75$Age),mauke75$Y,cex=0.45,pch=16,col=alpha(cols[1],alpha=0.6))#
	points(jitter(mauke92$Age),mauke92$Y,cex=0.45,pch=16,col=alpha(cols[2],alpha=0.6))#
	lines(mauke75$Age,mauke75$pY,col=cols[1],lwd=2)#
	lines(mauke92$Age,mauke92$pY,col=cols[2],lwd=2)#
	# Axis labels#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	mtext("Age, years",side=1,line=3,cex=1.5)#
	mtext("A",line=1,at=-10,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x][","][a]),")")),line=1,cex=1.5)#
	# Group labels#
	mtext("1975",side=4,line=0.5,adj=0,at=5.1,col=cols[1],cex=1.25,las=1)#
	mtext("1992\n(Post-MDA)",side=4,line=0.5,adj=0,at=4.6,col=cols[2],cex=1.25,las=1)#
par(op)#
#
# skinny plot of E(Y_x) for all ages (Not used)#
	# op <- par(mar=c(5,0,3,0)+0.1)#
	# plot(1,1,type="n",#
		# xlim=c(0,1),xaxt="n",xlab="",#
		# ylim=range(ytics),ylab="",yaxt="n",#
		# las=1,bty="n"#
	# )#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=1,line=1)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=0)#
	# # plot data#
	# segments(x0=0.5,y0=EYx.mauke75$lb, y1=EYx.mauke75$ub,lwd=1,col=cols[1])#
	# points(0.5,EYx.mauke75$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[1])#
	# segments(x0=0.5,y0=EYx.mauke92$lb, y1=EYx.mauke92$ub,lwd=1,col=cols[2])#
	# points(0.5,EYx.mauke92$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[2])#
# par(op)#
# dev.off()#
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=1)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 2-mauke-Wb123-figure.R#
# Ben Arnold#
##
# Plot age-specific antibody curves from #
# Mauke and beeswarm plot of age-stratified#
# means#
##
# version 1 (26 mar 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot#
#-------------------------------------------#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis.pdf",width=14,height=6)#
# cols1 <- brewer.pal(8,"Set1")[c(3)]#
# cols2 <- brewer.pal(11,"Spectral")[c(11)]#
# cols <- c(cols2,cols1)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
lo <- layout(mat=matrix(1:2,nrow=1,ncol=2,byrow=TRUE),widths=c(1,1))#
# Panel A age-specific antibody curves E(Y_x,a)#
op <- par(mar=c(5,5,3,4)+0.1)#
ytics <- 2:6#
plot(mauke75$Age,mauke75$pY,type="n",#
	xlab="",xaxt="n",xlim=c(0,70),#
	ylab="",yaxt="n",ylim=range(ytics),#
	main="",#
	las=1,bty="n"#
	)#
	axis(1,at=seq(0,70,by=10),cex.axis=1.5)#
	axis(2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# abline(log(10986),0,lty=2,col="gray60")#
	set.seed(623) # jitter ages (but not actual fits) to better display the data#
	points(jitter(mauke75$Age),mauke75$Y,cex=0.45,pch=16,col=alpha(cols[1],alpha=0.6))#
	points(jitter(mauke92$Age),mauke92$Y,cex=0.45,pch=16,col=alpha(cols[2],alpha=0.6))#
	lines(mauke75$Age,mauke75$pY,col=cols[1],lwd=2)#
	lines(mauke92$Age,mauke92$pY,col=cols[2],lwd=2)#
	# Axis labels#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	mtext("Age, years",side=1,line=3,cex=1.5)#
	mtext("A",line=1,at=-10,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x][","][a]),")")),line=1,cex=1.5)#
	# Group labels#
	mtext("1975",side=4,line=0.5,adj=0,at=5.1,col=cols[1],cex=1.25,las=1)#
	mtext("1992\n(Post-MDA)",side=4,line=0.5,adj=0,at=4.65,col=cols[2],cex=1.25,las=1)#
par(op)#
#
# skinny plot of E(Y_x) for all ages (Not used)#
	# op <- par(mar=c(5,0,3,0)+0.1)#
	# plot(1,1,type="n",#
		# xlim=c(0,1),xaxt="n",xlab="",#
		# ylim=range(ytics),ylab="",yaxt="n",#
		# las=1,bty="n"#
	# )#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=1,line=1)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=0)#
	# # plot data#
	# segments(x0=0.5,y0=EYx.mauke75$lb, y1=EYx.mauke75$ub,lwd=1,col=cols[1])#
	# points(0.5,EYx.mauke75$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[1])#
	# segments(x0=0.5,y0=EYx.mauke92$lb, y1=EYx.mauke92$ub,lwd=1,col=cols[2])#
	# points(0.5,EYx.mauke92$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[2])#
# par(op)#
# dev.off()#
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=1)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 2-mauke-Wb123-figure.R#
# Ben Arnold#
##
# Plot age-specific antibody curves from #
# Mauke and beeswarm plot of age-stratified#
# means#
##
# version 1 (26 mar 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot#
#-------------------------------------------#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis.pdf",width=14,height=6)#
# cols1 <- brewer.pal(8,"Set1")[c(3)]#
# cols2 <- brewer.pal(11,"Spectral")[c(11)]#
# cols <- c(cols2,cols1)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
lo <- layout(mat=matrix(1:2,nrow=1,ncol=2,byrow=TRUE),widths=c(1,1))#
# Panel A age-specific antibody curves E(Y_x,a)#
op <- par(mar=c(5,5,3,4)+0.1)#
ytics <- 2:6#
plot(mauke75$Age,mauke75$pY,type="n",#
	xlab="",xaxt="n",xlim=c(0,70),#
	ylab="",yaxt="n",ylim=range(ytics),#
	main="",#
	las=1,bty="n"#
	)#
	axis(1,at=seq(0,70,by=10),cex.axis=1.5)#
	axis(2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# abline(log(10986),0,lty=2,col="gray60")#
	set.seed(623) # jitter ages (but not actual fits) to better display the data#
	points(jitter(mauke75$Age),mauke75$Y,cex=0.45,pch=16,col=alpha(cols[1],alpha=0.6))#
	points(jitter(mauke92$Age),mauke92$Y,cex=0.45,pch=16,col=alpha(cols[2],alpha=0.6))#
	lines(mauke75$Age,mauke75$pY,col=cols[1],lwd=2)#
	lines(mauke92$Age,mauke92$pY,col=cols[2],lwd=2)#
	# Axis labels#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	mtext("Age, years",side=1,line=3,cex=1.5)#
	mtext("A",line=1,at=-10,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x][","][a]),")")),line=1,cex=1.5)#
	# Group labels#
	mtext("1975",side=4,line=0.5,adj=0,at=5.1,col=cols[1],cex=1.25,las=1)#
	mtext("1992\n(Post-MDA)",side=4,line=0.5,adj=0,at=4.65,col=cols[2],cex=1.25,las=1)#
par(op)#
#
# skinny plot of E(Y_x) for all ages (Not used)#
	# op <- par(mar=c(5,0,3,0)+0.1)#
	# plot(1,1,type="n",#
		# xlim=c(0,1),xaxt="n",xlab="",#
		# ylim=range(ytics),ylab="",yaxt="n",#
		# las=1,bty="n"#
	# )#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=1,line=1)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=0)#
	# # plot data#
	# segments(x0=0.5,y0=EYx.mauke75$lb, y1=EYx.mauke75$ub,lwd=1,col=cols[1])#
	# points(0.5,EYx.mauke75$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[1])#
	# segments(x0=0.5,y0=EYx.mauke92$lb, y1=EYx.mauke92$ub,lwd=1,col=cols[2])#
	# points(0.5,EYx.mauke92$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[2])#
# par(op)#
# dev.off()#
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975\n","1992\n(post-MDA)"),at=c(1,2),cols=cols[1:2],side=3,line=0)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 2-mauke-Wb123-figure.R#
# Ben Arnold#
##
# Plot age-specific antibody curves from #
# Mauke and beeswarm plot of age-stratified#
# means#
##
# version 1 (26 mar 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot#
#-------------------------------------------#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis.pdf",width=14,height=6)#
# cols1 <- brewer.pal(8,"Set1")[c(3)]#
# cols2 <- brewer.pal(11,"Spectral")[c(11)]#
# cols <- c(cols2,cols1)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
lo <- layout(mat=matrix(1:2,nrow=1,ncol=2,byrow=TRUE),widths=c(1,1))#
# Panel A age-specific antibody curves E(Y_x,a)#
op <- par(mar=c(5,5,3,4)+0.1)#
ytics <- 2:6#
plot(mauke75$Age,mauke75$pY,type="n",#
	xlab="",xaxt="n",xlim=c(0,70),#
	ylab="",yaxt="n",ylim=range(ytics),#
	main="",#
	las=1,bty="n"#
	)#
	axis(1,at=seq(0,70,by=10),cex.axis=1.5)#
	axis(2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# abline(log(10986),0,lty=2,col="gray60")#
	set.seed(623) # jitter ages (but not actual fits) to better display the data#
	points(jitter(mauke75$Age),mauke75$Y,cex=0.45,pch=16,col=alpha(cols[1],alpha=0.6))#
	points(jitter(mauke92$Age),mauke92$Y,cex=0.45,pch=16,col=alpha(cols[2],alpha=0.6))#
	lines(mauke75$Age,mauke75$pY,col=cols[1],lwd=2)#
	lines(mauke92$Age,mauke92$pY,col=cols[2],lwd=2)#
	# Axis labels#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	mtext("Age, years",side=1,line=3,cex=1.5)#
	mtext("A",line=1,at=-10,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x][","][a]),")")),line=1,cex=1.5)#
	# Group labels#
	mtext("1975",side=4,line=0.5,adj=0,at=5.1,col=cols[1],cex=1.25,las=1)#
	mtext("1992\n(Post-MDA)",side=4,line=0.5,adj=0,at=4.65,col=cols[2],cex=1.25,las=1)#
par(op)#
#
# skinny plot of E(Y_x) for all ages (Not used)#
	# op <- par(mar=c(5,0,3,0)+0.1)#
	# plot(1,1,type="n",#
		# xlim=c(0,1),xaxt="n",xlab="",#
		# ylim=range(ytics),ylab="",yaxt="n",#
		# las=1,bty="n"#
	# )#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=1,line=1)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=0)#
	# # plot data#
	# segments(x0=0.5,y0=EYx.mauke75$lb, y1=EYx.mauke75$ub,lwd=1,col=cols[1])#
	# points(0.5,EYx.mauke75$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[1])#
	# segments(x0=0.5,y0=EYx.mauke92$lb, y1=EYx.mauke92$ub,lwd=1,col=cols[2])#
	# points(0.5,EYx.mauke92$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[2])#
# par(op)#
# dev.off()#
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),cols=cols[1:2],side=3,line=0)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 2-mauke-Wb123-figure.R#
# Ben Arnold#
##
# Plot age-specific antibody curves from #
# Mauke and beeswarm plot of age-stratified#
# means#
##
# version 1 (26 mar 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot#
#-------------------------------------------#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis.pdf",width=14,height=6)#
# cols1 <- brewer.pal(8,"Set1")[c(3)]#
# cols2 <- brewer.pal(11,"Spectral")[c(11)]#
# cols <- c(cols2,cols1)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
lo <- layout(mat=matrix(1:2,nrow=1,ncol=2,byrow=TRUE),widths=c(1,1))#
# Panel A age-specific antibody curves E(Y_x,a)#
op <- par(mar=c(5,5,3,4)+0.1)#
ytics <- 2:6#
plot(mauke75$Age,mauke75$pY,type="n",#
	xlab="",xaxt="n",xlim=c(0,70),#
	ylab="",yaxt="n",ylim=range(ytics),#
	main="",#
	las=1,bty="n"#
	)#
	axis(1,at=seq(0,70,by=10),cex.axis=1.5)#
	axis(2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# abline(log(10986),0,lty=2,col="gray60")#
	set.seed(623) # jitter ages (but not actual fits) to better display the data#
	points(jitter(mauke75$Age),mauke75$Y,cex=0.45,pch=16,col=alpha(cols[1],alpha=0.6))#
	points(jitter(mauke92$Age),mauke92$Y,cex=0.45,pch=16,col=alpha(cols[2],alpha=0.6))#
	lines(mauke75$Age,mauke75$pY,col=cols[1],lwd=2)#
	lines(mauke92$Age,mauke92$pY,col=cols[2],lwd=2)#
	# Axis labels#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	mtext("Age, years",side=1,line=3,cex=1.5)#
	mtext("A",line=1,at=-10,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x][","][a]),")")),line=1,cex=1.5)#
	# Group labels#
	mtext("1975",side=4,line=0.5,adj=0,at=5.1,col=cols[1],cex=1.25,las=1)#
	mtext("1992\n(Post-MDA)",side=4,line=0.5,adj=0,at=4.65,col=cols[2],cex=1.25,las=1)#
par(op)#
#
# skinny plot of E(Y_x) for all ages (Not used)#
	# op <- par(mar=c(5,0,3,0)+0.1)#
	# plot(1,1,type="n",#
		# xlim=c(0,1),xaxt="n",xlab="",#
		# ylim=range(ytics),ylab="",yaxt="n",#
		# las=1,bty="n"#
	# )#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=1,line=1)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=0)#
	# # plot data#
	# segments(x0=0.5,y0=EYx.mauke75$lb, y1=EYx.mauke75$ub,lwd=1,col=cols[1])#
	# points(0.5,EYx.mauke75$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[1])#
	# segments(x0=0.5,y0=EYx.mauke92$lb, y1=EYx.mauke92$ub,lwd=1,col=cols[2])#
	# points(0.5,EYx.mauke92$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[2])#
# par(op)#
# dev.off()#
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 2-mauke-Wb123-figure.R#
# Ben Arnold#
##
# Plot age-specific antibody curves from #
# Mauke and beeswarm plot of age-stratified#
# means#
##
# version 1 (26 mar 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot#
#-------------------------------------------#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis.pdf",width=14,height=6)#
# cols1 <- brewer.pal(8,"Set1")[c(3)]#
# cols2 <- brewer.pal(11,"Spectral")[c(11)]#
# cols <- c(cols2,cols1)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
lo <- layout(mat=matrix(1:2,nrow=1,ncol=2,byrow=TRUE),widths=c(1,1))#
# Panel A age-specific antibody curves E(Y_x,a)#
op <- par(mar=c(5,5,3,4)+0.1)#
ytics <- 2:6#
plot(mauke75$Age,mauke75$pY,type="n",#
	xlab="",xaxt="n",xlim=c(0,70),#
	ylab="",yaxt="n",ylim=range(ytics),#
	main="",#
	las=1,bty="n"#
	)#
	axis(1,at=seq(0,70,by=10),cex.axis=1.5)#
	axis(2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# abline(log(10986),0,lty=2,col="gray60")#
	set.seed(623) # jitter ages (but not actual fits) to better display the data#
	points(jitter(mauke75$Age),mauke75$Y,cex=0.45,pch=16,col=alpha(cols[1],alpha=0.6))#
	points(jitter(mauke92$Age),mauke92$Y,cex=0.45,pch=16,col=alpha(cols[2],alpha=0.6))#
	lines(mauke75$Age,mauke75$pY,col=cols[1],lwd=2)#
	lines(mauke92$Age,mauke92$pY,col=cols[2],lwd=2)#
	# Axis labels#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	mtext("Age, years",side=1,line=3,cex=1.5)#
	mtext("A",line=1,at=-10,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x][","][a]),")")),line=1,cex=1.5)#
	# Group labels#
	mtext("1975",side=4,line=0.5,adj=0,at=5.1,col=cols[1],cex=1.25,las=1)#
	mtext("1992\n(Post-MDA)",side=4,line=0.5,adj=0,at=4.7,col=cols[2],cex=1.25,las=1)#
	mtext("(5 y Post-MDA)",side=4,line=0.5,adj=0,at=46.,col=cols[2],cex=1,las=1)#
par(op)#
#
# skinny plot of E(Y_x) for all ages (Not used)#
	# op <- par(mar=c(5,0,3,0)+0.1)#
	# plot(1,1,type="n",#
		# xlim=c(0,1),xaxt="n",xlab="",#
		# ylim=range(ytics),ylab="",yaxt="n",#
		# las=1,bty="n"#
	# )#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=1,line=1)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=0)#
	# # plot data#
	# segments(x0=0.5,y0=EYx.mauke75$lb, y1=EYx.mauke75$ub,lwd=1,col=cols[1])#
	# points(0.5,EYx.mauke75$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[1])#
	# segments(x0=0.5,y0=EYx.mauke92$lb, y1=EYx.mauke92$ub,lwd=1,col=cols[2])#
	# points(0.5,EYx.mauke92$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[2])#
# par(op)#
# dev.off()#
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
mtext("(5 y Post-MDA)",side=4,line=0.5,adj=0,at=4.6,col=cols[2],cex=1,las=1)
#-------------------------------------------#
# 2-mauke-Wb123-figure.R#
# Ben Arnold#
##
# Plot age-specific antibody curves from #
# Mauke and beeswarm plot of age-stratified#
# means#
##
# version 1 (26 mar 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot#
#-------------------------------------------#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis.pdf",width=14,height=6)#
# cols1 <- brewer.pal(8,"Set1")[c(3)]#
# cols2 <- brewer.pal(11,"Spectral")[c(11)]#
# cols <- c(cols2,cols1)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
lo <- layout(mat=matrix(1:2,nrow=1,ncol=2,byrow=TRUE),widths=c(1,1))#
# Panel A age-specific antibody curves E(Y_x,a)#
op <- par(mar=c(5,5,3,4)+0.1)#
ytics <- 2:6#
plot(mauke75$Age,mauke75$pY,type="n",#
	xlab="",xaxt="n",xlim=c(0,70),#
	ylab="",yaxt="n",ylim=range(ytics),#
	main="",#
	las=1,bty="n"#
	)#
	axis(1,at=seq(0,70,by=10),cex.axis=1.5)#
	axis(2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# abline(log(10986),0,lty=2,col="gray60")#
	set.seed(623) # jitter ages (but not actual fits) to better display the data#
	points(jitter(mauke75$Age),mauke75$Y,cex=0.45,pch=16,col=alpha(cols[1],alpha=0.6))#
	points(jitter(mauke92$Age),mauke92$Y,cex=0.45,pch=16,col=alpha(cols[2],alpha=0.6))#
	lines(mauke75$Age,mauke75$pY,col=cols[1],lwd=2)#
	lines(mauke92$Age,mauke92$pY,col=cols[2],lwd=2)#
	# Axis labels#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	mtext("Age, years",side=1,line=3,cex=1.5)#
	mtext("A",line=1,at=-10,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x][","][a]),")")),line=1,cex=1.5)#
	# Group labels#
	mtext("1975",side=4,line=0.5,adj=0,at=5.1,col=cols[1],cex=1.25,las=1)#
	mtext("1992\n(Post-MDA)",side=4,line=0.5,adj=0,at=4.7,col=cols[2],cex=1.25,las=1)#
	mtext("(5 y Post-MDA)",side=4,line=0.5,adj=0,at=4.6,col=cols[2],cex=1,las=1)#
par(op)#
#
# skinny plot of E(Y_x) for all ages (Not used)#
	# op <- par(mar=c(5,0,3,0)+0.1)#
	# plot(1,1,type="n",#
		# xlim=c(0,1),xaxt="n",xlab="",#
		# ylim=range(ytics),ylab="",yaxt="n",#
		# las=1,bty="n"#
	# )#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=1,line=1)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=0)#
	# # plot data#
	# segments(x0=0.5,y0=EYx.mauke75$lb, y1=EYx.mauke75$ub,lwd=1,col=cols[1])#
	# points(0.5,EYx.mauke75$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[1])#
	# segments(x0=0.5,y0=EYx.mauke92$lb, y1=EYx.mauke92$ub,lwd=1,col=cols[2])#
	# points(0.5,EYx.mauke92$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[2])#
# par(op)#
# dev.off()#
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 2-mauke-Wb123-figure.R#
# Ben Arnold#
##
# Plot age-specific antibody curves from #
# Mauke and beeswarm plot of age-stratified#
# means#
##
# version 1 (26 mar 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot#
#-------------------------------------------#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis.pdf",width=14,height=6)#
# cols1 <- brewer.pal(8,"Set1")[c(3)]#
# cols2 <- brewer.pal(11,"Spectral")[c(11)]#
# cols <- c(cols2,cols1)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
lo <- layout(mat=matrix(1:2,nrow=1,ncol=2,byrow=TRUE),widths=c(1,1))#
# Panel A age-specific antibody curves E(Y_x,a)#
op <- par(mar=c(5,5,3,4)+0.1)#
ytics <- 2:6#
plot(mauke75$Age,mauke75$pY,type="n",#
	xlab="",xaxt="n",xlim=c(0,70),#
	ylab="",yaxt="n",ylim=range(ytics),#
	main="",#
	las=1,bty="n"#
	)#
	axis(1,at=seq(0,70,by=10),cex.axis=1.5)#
	axis(2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# abline(log(10986),0,lty=2,col="gray60")#
	set.seed(623) # jitter ages (but not actual fits) to better display the data#
	points(jitter(mauke75$Age),mauke75$Y,cex=0.45,pch=16,col=alpha(cols[1],alpha=0.6))#
	points(jitter(mauke92$Age),mauke92$Y,cex=0.45,pch=16,col=alpha(cols[2],alpha=0.6))#
	lines(mauke75$Age,mauke75$pY,col=cols[1],lwd=2)#
	lines(mauke92$Age,mauke92$pY,col=cols[2],lwd=2)#
	# Axis labels#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	mtext("Age, years",side=1,line=3,cex=1.5)#
	mtext("A",line=1,at=-10,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x][","][a]),")")),line=1,cex=1.5)#
	# Group labels#
	mtext("1975",side=4,line=0.5,adj=0,at=5.1,col=cols[1],cex=1.25,las=1)#
	mtext("1992",side=4,line=0.5,adj=0,at=4.7,col=cols[2],cex=1.25,las=1)#
	mtext("(5 y Post-MDA)",side=4,line=0.5,adj=0,at=4.6,col=cols[2],cex=1,las=1)#
par(op)#
#
# skinny plot of E(Y_x) for all ages (Not used)#
	# op <- par(mar=c(5,0,3,0)+0.1)#
	# plot(1,1,type="n",#
		# xlim=c(0,1),xaxt="n",xlab="",#
		# ylim=range(ytics),ylab="",yaxt="n",#
		# las=1,bty="n"#
	# )#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=1,line=1)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=0)#
	# # plot data#
	# segments(x0=0.5,y0=EYx.mauke75$lb, y1=EYx.mauke75$ub,lwd=1,col=cols[1])#
	# points(0.5,EYx.mauke75$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[1])#
	# segments(x0=0.5,y0=EYx.mauke92$lb, y1=EYx.mauke92$ub,lwd=1,col=cols[2])#
	# points(0.5,EYx.mauke92$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[2])#
# par(op)#
# dev.off()#
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 2-mauke-Wb123-figure.R#
# Ben Arnold#
##
# Plot age-specific antibody curves from #
# Mauke and beeswarm plot of age-stratified#
# means#
##
# version 1 (26 mar 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot#
#-------------------------------------------#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis.pdf",width=14,height=6)#
# cols1 <- brewer.pal(8,"Set1")[c(3)]#
# cols2 <- brewer.pal(11,"Spectral")[c(11)]#
# cols <- c(cols2,cols1)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
lo <- layout(mat=matrix(1:2,nrow=1,ncol=2,byrow=TRUE),widths=c(1,1))#
# Panel A age-specific antibody curves E(Y_x,a)#
op <- par(mar=c(5,5,3,4)+0.1)#
ytics <- 2:6#
plot(mauke75$Age,mauke75$pY,type="n",#
	xlab="",xaxt="n",xlim=c(0,70),#
	ylab="",yaxt="n",ylim=range(ytics),#
	main="",#
	las=1,bty="n"#
	)#
	axis(1,at=seq(0,70,by=10),cex.axis=1.5)#
	axis(2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# abline(log(10986),0,lty=2,col="gray60")#
	set.seed(623) # jitter ages (but not actual fits) to better display the data#
	points(jitter(mauke75$Age),mauke75$Y,cex=0.45,pch=16,col=alpha(cols[1],alpha=0.6))#
	points(jitter(mauke92$Age),mauke92$Y,cex=0.45,pch=16,col=alpha(cols[2],alpha=0.6))#
	lines(mauke75$Age,mauke75$pY,col=cols[1],lwd=2)#
	lines(mauke92$Age,mauke92$pY,col=cols[2],lwd=2)#
	# Axis labels#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	mtext("Age, years",side=1,line=3,cex=1.5)#
	mtext("A",line=1,at=-10,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x][","][a]),")")),line=1,cex=1.5)#
	# Group labels#
	mtext("1975",side=4,line=0.5,adj=0,at=5.1,col=cols[1],cex=1.25,las=1)#
	mtext("1992",side=4,line=0.5,adj=0,at=4.7,col=cols[2],cex=1.25,las=1)#
	mtext("(5 y Post-MDA)",side=4,line=0.5,adj=0,at=4.5,col=cols[2],cex=1,las=1)#
par(op)#
#
# skinny plot of E(Y_x) for all ages (Not used)#
	# op <- par(mar=c(5,0,3,0)+0.1)#
	# plot(1,1,type="n",#
		# xlim=c(0,1),xaxt="n",xlab="",#
		# ylim=range(ytics),ylab="",yaxt="n",#
		# las=1,bty="n"#
	# )#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=1,line=1)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=0)#
	# # plot data#
	# segments(x0=0.5,y0=EYx.mauke75$lb, y1=EYx.mauke75$ub,lwd=1,col=cols[1])#
	# points(0.5,EYx.mauke75$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[1])#
	# segments(x0=0.5,y0=EYx.mauke92$lb, y1=EYx.mauke92$ub,lwd=1,col=cols[2])#
	# points(0.5,EYx.mauke92$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[2])#
# par(op)#
# dev.off()#
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 2-mauke-Wb123-figure.R#
# Ben Arnold#
##
# Plot age-specific antibody curves from #
# Mauke and beeswarm plot of age-stratified#
# means#
##
# version 1 (26 mar 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot#
#-------------------------------------------#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis.pdf",width=14,height=6)#
# cols1 <- brewer.pal(8,"Set1")[c(3)]#
# cols2 <- brewer.pal(11,"Spectral")[c(11)]#
# cols <- c(cols2,cols1)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
lo <- layout(mat=matrix(1:2,nrow=1,ncol=2,byrow=TRUE),widths=c(1,1))#
# Panel A age-specific antibody curves E(Y_x,a)#
op <- par(mar=c(5,5,3,4)+0.1)#
ytics <- 2:6#
plot(mauke75$Age,mauke75$pY,type="n",#
	xlab="",xaxt="n",xlim=c(0,70),#
	ylab="",yaxt="n",ylim=range(ytics),#
	main="",#
	las=1,bty="n"#
	)#
	axis(1,at=seq(0,70,by=10),cex.axis=1.5)#
	axis(2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# abline(log(10986),0,lty=2,col="gray60")#
	set.seed(623) # jitter ages (but not actual fits) to better display the data#
	points(jitter(mauke75$Age),mauke75$Y,cex=0.45,pch=16,col=alpha(cols[1],alpha=0.6))#
	points(jitter(mauke92$Age),mauke92$Y,cex=0.45,pch=16,col=alpha(cols[2],alpha=0.6))#
	lines(mauke75$Age,mauke75$pY,col=cols[1],lwd=2)#
	lines(mauke92$Age,mauke92$pY,col=cols[2],lwd=2)#
	# Axis labels#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	mtext("Age, years",side=1,line=3,cex=1.5)#
	mtext("A",line=1,at=-10,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x][","][a]),")")),line=1,cex=1.5)#
	# Group labels#
	mtext("1975",side=4,line=0.5,adj=0,at=5.1,col=cols[1],cex=1.25,las=1)#
	mtext("1992",side=4,line=0.5,adj=0,at=4.71,col=cols[2],cex=1.25,las=1)#
	mtext("(5 y Post-MDA)",side=4,line=0.5,adj=0,at=4.45,col=cols[2],cex=1,las=1)#
par(op)#
#
# skinny plot of E(Y_x) for all ages (Not used)#
	# op <- par(mar=c(5,0,3,0)+0.1)#
	# plot(1,1,type="n",#
		# xlim=c(0,1),xaxt="n",xlab="",#
		# ylim=range(ytics),ylab="",yaxt="n",#
		# las=1,bty="n"#
	# )#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=1,line=1)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=0)#
	# # plot data#
	# segments(x0=0.5,y0=EYx.mauke75$lb, y1=EYx.mauke75$ub,lwd=1,col=cols[1])#
	# points(0.5,EYx.mauke75$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[1])#
	# segments(x0=0.5,y0=EYx.mauke92$lb, y1=EYx.mauke92$ub,lwd=1,col=cols[2])#
	# points(0.5,EYx.mauke92$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[2])#
# par(op)#
# dev.off()#
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 2-mauke-Wb123-figure.R#
# Ben Arnold#
##
# Plot age-specific antibody curves from #
# Mauke and beeswarm plot of age-stratified#
# means#
##
# version 1 (26 mar 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot#
#-------------------------------------------#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis.pdf",width=14,height=6)#
# cols1 <- brewer.pal(8,"Set1")[c(3)]#
# cols2 <- brewer.pal(11,"Spectral")[c(11)]#
# cols <- c(cols2,cols1)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
lo <- layout(mat=matrix(1:2,nrow=1,ncol=2,byrow=TRUE),widths=c(1,1))#
# Panel A age-specific antibody curves E(Y_x,a)#
op <- par(mar=c(5,5,3,4)+0.1)#
ytics <- 2:6#
plot(mauke75$Age,mauke75$pY,type="n",#
	xlab="",xaxt="n",xlim=c(0,70),#
	ylab="",yaxt="n",ylim=range(ytics),#
	main="",#
	las=1,bty="n"#
	)#
	axis(1,at=seq(0,70,by=10),cex.axis=1.5)#
	axis(2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# abline(log(10986),0,lty=2,col="gray60")#
	set.seed(623) # jitter ages (but not actual fits) to better display the data#
	points(jitter(mauke75$Age),mauke75$Y,cex=0.45,pch=16,col=alpha(cols[1],alpha=0.6))#
	points(jitter(mauke92$Age),mauke92$Y,cex=0.45,pch=16,col=alpha(cols[2],alpha=0.6))#
	lines(mauke75$Age,mauke75$pY,col=cols[1],lwd=2)#
	lines(mauke92$Age,mauke92$pY,col=cols[2],lwd=2)#
	# Axis labels#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	mtext("Age, years",side=1,line=3,cex=1.5)#
	mtext("A",line=1,at=-10,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x][","][a]),")")),line=1,cex=1.5)#
	# Group labels#
	mtext("1975",side=4,line=0.5,adj=0,at=5.1,col=cols[1],cex=1.25,las=1)#
	mtext("1992",side=4,line=0.5,adj=0,at=4.75,col=cols[2],cex=1.25,las=1)#
	mtext("(5 y Post-MDA)",side=4,line=0.5,adj=0,at=4.45,col=cols[2],cex=1,las=1)#
par(op)#
#
# skinny plot of E(Y_x) for all ages (Not used)#
	# op <- par(mar=c(5,0,3,0)+0.1)#
	# plot(1,1,type="n",#
		# xlim=c(0,1),xaxt="n",xlab="",#
		# ylim=range(ytics),ylab="",yaxt="n",#
		# las=1,bty="n"#
	# )#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=1,line=1)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=0)#
	# # plot data#
	# segments(x0=0.5,y0=EYx.mauke75$lb, y1=EYx.mauke75$ub,lwd=1,col=cols[1])#
	# points(0.5,EYx.mauke75$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[1])#
	# segments(x0=0.5,y0=EYx.mauke92$lb, y1=EYx.mauke92$ub,lwd=1,col=cols[2])#
	# points(0.5,EYx.mauke92$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[2])#
# par(op)#
# dev.off()#
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 2-mauke-Wb123-figure.R#
# Ben Arnold#
##
# Plot age-specific antibody curves from #
# Mauke and beeswarm plot of age-stratified#
# means#
##
# version 1 (26 mar 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot#
#-------------------------------------------#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis.pdf",width=14,height=6)#
# cols1 <- brewer.pal(8,"Set1")[c(3)]#
# cols2 <- brewer.pal(11,"Spectral")[c(11)]#
# cols <- c(cols2,cols1)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
lo <- layout(mat=matrix(1:2,nrow=1,ncol=2,byrow=TRUE),widths=c(1,1))#
# Panel A age-specific antibody curves E(Y_x,a)#
op <- par(mar=c(5,5,3,4)+0.1)#
ytics <- 2:6#
plot(mauke75$Age,mauke75$pY,type="n",#
	xlab="",xaxt="n",xlim=c(0,70),#
	ylab="",yaxt="n",ylim=range(ytics),#
	main="",#
	las=1,bty="n"#
	)#
	axis(1,at=seq(0,70,by=10),cex.axis=1.5)#
	axis(2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# abline(log(10986),0,lty=2,col="gray60")#
	set.seed(623) # jitter ages (but not actual fits) to better display the data#
	points(jitter(mauke75$Age),mauke75$Y,cex=0.45,pch=16,col=alpha(cols[1],alpha=0.6))#
	points(jitter(mauke92$Age),mauke92$Y,cex=0.45,pch=16,col=alpha(cols[2],alpha=0.6))#
	lines(mauke75$Age,mauke75$pY,col=cols[1],lwd=2)#
	lines(mauke92$Age,mauke92$pY,col=cols[2],lwd=2)#
	# Axis labels#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	mtext("Age, years",side=1,line=3,cex=1.5)#
	mtext("A",line=1,at=-10,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x][","][a]),")")),line=1,cex=1.5)#
	# Group labels#
	mtext("1975",side=4,line=0.5,adj=0,at=5.1,col=cols[1],cex=1.25,las=1)#
	mtext("1992",side=4,line=0.5,adj=0,at=4.75,col=cols[2],cex=1.25,las=1)#
	mtext("(5 y Post-MDA)",side=4,line=0.5,adj=0,at=4.5,col=cols[2],cex=1,las=1)#
par(op)#
#
# skinny plot of E(Y_x) for all ages (Not used)#
	# op <- par(mar=c(5,0,3,0)+0.1)#
	# plot(1,1,type="n",#
		# xlim=c(0,1),xaxt="n",xlab="",#
		# ylim=range(ytics),ylab="",yaxt="n",#
		# las=1,bty="n"#
	# )#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=1,line=1)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=0)#
	# # plot data#
	# segments(x0=0.5,y0=EYx.mauke75$lb, y1=EYx.mauke75$ub,lwd=1,col=cols[1])#
	# points(0.5,EYx.mauke75$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[1])#
	# segments(x0=0.5,y0=EYx.mauke92$lb, y1=EYx.mauke92$ub,lwd=1,col=cols[2])#
	# points(0.5,EYx.mauke92$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[2])#
# par(op)#
# dev.off()#
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 2-mauke-Wb123-figure.R#
# Ben Arnold#
##
# Plot age-specific antibody curves from #
# Mauke and beeswarm plot of age-stratified#
# means#
##
# version 1 (26 mar 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot#
#-------------------------------------------#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis.pdf",width=14,height=6)#
# cols1 <- brewer.pal(8,"Set1")[c(3)]#
# cols2 <- brewer.pal(11,"Spectral")[c(11)]#
# cols <- c(cols2,cols1)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
lo <- layout(mat=matrix(1:2,nrow=1,ncol=2,byrow=TRUE),widths=c(1,1))#
# Panel A age-specific antibody curves E(Y_x,a)#
op <- par(mar=c(5,5,3,4)+0.1)#
ytics <- 2:6#
plot(mauke75$Age,mauke75$pY,type="n",#
	xlab="",xaxt="n",xlim=c(0,70),#
	ylab="",yaxt="n",ylim=range(ytics),#
	main="",#
	las=1,bty="n"#
	)#
	axis(1,at=seq(0,70,by=10),cex.axis=1.5)#
	axis(2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# abline(log(10986),0,lty=2,col="gray60")#
	set.seed(623) # jitter ages (but not actual fits) to better display the data#
	points(jitter(mauke75$Age),mauke75$Y,cex=0.45,pch=16,col=alpha(cols[1],alpha=0.6))#
	points(jitter(mauke92$Age),mauke92$Y,cex=0.45,pch=16,col=alpha(cols[2],alpha=0.6))#
	lines(mauke75$Age,mauke75$pY,col=cols[1],lwd=2)#
	lines(mauke92$Age,mauke92$pY,col=cols[2],lwd=2)#
	# Axis labels#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	mtext("Age, years",side=1,line=3,cex=1.5)#
	mtext("A",line=1,at=-10,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x][","][a]),")")),line=1,cex=1.5)#
	# Group labels#
	mtext("1975",side=4,line=0.5,adj=0,at=5.1,col=cols[1],cex=1.25,las=1)#
	mtext("1992",side=4,line=0.5,adj=0,at=4.75,col=cols[2],cex=1.25,las=1)#
	mtext("(5y Post-MDA)",side=4,line=0.5,adj=0,at=4.5,col=cols[2],cex=1,las=1)#
par(op)#
#
# skinny plot of E(Y_x) for all ages (Not used)#
	# op <- par(mar=c(5,0,3,0)+0.1)#
	# plot(1,1,type="n",#
		# xlim=c(0,1),xaxt="n",xlab="",#
		# ylim=range(ytics),ylab="",yaxt="n",#
		# las=1,bty="n"#
	# )#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=1,line=1)#
	# mtext(expression(paste(italic(E),"(",italic(Y[x]),")")),side=3,line=0)#
	# # plot data#
	# segments(x0=0.5,y0=EYx.mauke75$lb, y1=EYx.mauke75$ub,lwd=1,col=cols[1])#
	# points(0.5,EYx.mauke75$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[1])#
	# segments(x0=0.5,y0=EYx.mauke92$lb, y1=EYx.mauke92$ub,lwd=1,col=cols[2])#
	# points(0.5,EYx.mauke92$psi, pch=21,cex=1.75, lwd=1,bg="white",col=cols[2])#
# par(op)#
# dev.off()#
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
ls()
Eyx.mauke75kids
EYx.mauke75kids
diff.maukekids
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means
dev.off()
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
# pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
# pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
# pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)
# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)
ls()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
# pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected pvalues#
	mtext(paste("p =",sprintf("%1.3f",unlist(diff.maukekids27)*5)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
# dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
# pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected pvalues#
	mtext(paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y)*5)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
# dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
# pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected pvalues#
	mtext(paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
# dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
# pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected pvalues#
	mtext(paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
# dev.off()
ls()
table(d7592$agecat2,d7592$mda)
table(a7592$agecat2,a7592$mda)
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
# pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected pvalues#
	mtext(paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
# dev.off()
ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))
ptext
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
# pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
# dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
# pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=-0.75,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
# dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
# pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=0,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
# dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
# pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=-0.25,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
# dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
# pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=2,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3.5,cex=1.5)#
	# Y label#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=0,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
# dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
# pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=14,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1.5,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3.5,cex=1.5)#
	# Y label#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=0,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
# dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=6,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1.5,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3.5,cex=1.5)#
	# Y label#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=0,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=7,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1.5,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3.5,cex=1.5)#
	# Y label#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=0,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=7,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1.5,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3.5,cex=1.5)#
	# Y label#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	# header#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=0,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
mtext(c("1975","1992 (post-MDA)"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=7,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1.5,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3.5,cex=1.5)#
	# Y label#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	# header#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992 (post-MDA)"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=0,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=7,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1.5,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3.5,cex=1.5)#
	# Y label#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	# header#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992","(post-MDA)"),at=c(1,2,3),col=cols[c(1,2,2)],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=0,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=7,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1.5,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3.5,cex=1.5)#
	# Y label#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	# header#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992","(post-MDA)"),at=c(1,2,4),col=cols[c(1,2,2)],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=0,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=7,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1.5,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3.5,cex=1.5)#
	# Y label#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	# header#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992","(post-MDA)"),at=c(1,2,3.5),col=cols[c(1,2,2)],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=0,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=7,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1.5,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3.5,cex=1.5)#
	# Y label#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	# header#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992","(post-MDA)"),at=c(1,2,3.25),col=cols[c(1,2,2)],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=0,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=7,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1.5,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3.5,cex=1.5)#
	# Y label#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	# header#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975\n","1992\n(post-MDA)"),at=c(1,2),col=cols[c(1,2)],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=0,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=7,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1.5,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3.5,cex=1.5)#
	# Y label#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	# header#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[c(1,2)],side=3,line=0.5)#
	mtext("(post-MDA)",at=2,col=cols[2],side=3,line=-0.5)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=0,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
mtext("(post-MDA)",at=2,col=cols[2],side=3,line=-0.5,cex=0.75)
#-------------------------------------------#
# 3-mauke-Wb123-supp-figure#
# Ben Arnold#
##
# Mauke beeswarm plot of age-stratified#
# means in 2 year age bands#
##
# version 1 (19 oct 2015)#
# #
##
#-------------------------------------------#
#
#-------------------------------------------#
# input files:#
#   mauke-Wb123-analysis.RData#
##
# output files:#
#   mauke-Wb123-analysis-2y-beeswarm.pdf#
#-------------------------------------------#
#-------------------------------------------#
# preamble#
#-------------------------------------------#
rm(list=ls())#
library(RColorBrewer)#
library(scales)#
library(beeswarm)#
#
#-------------------------------------------#
# load the Mauke analysis results#
#-------------------------------------------#
#
load("~/SLAbcurves/results/raw/mauke-Wb123-analysis.RData")#
#-------------------------------------------#
# plot E(Y_x) in 2 year age bands#
# for a supplemental figure#
#-------------------------------------------#
#
pdf("~/SLAbcurves/results/figs/mauke-Wb123-analysis-2y-beeswarm.pdf",width=7,height=6)#
#
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")#
cols <- cbPalette[c(7,6)]#
#
op <- par(mar=c(5,5,3,1)+0.1)#
ytics <- 2:6#
set.seed(23423) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat2,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat2),side=1,line=1.5,at=c(1.5,3.5,5.5,7.5,9.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5,8.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3.5,cex=1.5)#
	# Y label#
	mtext(expression(paste(italic('Wuchereria bancrofti')," Wb123 (Light Units)")),side=2,line=3,cex=1.25)#
	# header#
	# mtext("A",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[c(1,2)],side=3,line=0.5)#
	mtext("(post-MDA)",at=2,col=cols[2],side=3,line=-0.5,cex=0.75)#
#
	# add in geometric means	#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke75kids2y[3,]), y1=unlist(EYx.mauke75kids2y[4,]), col=cols[1],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke75kids2y[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5,9.5), y0=unlist(EYx.mauke92kids2y[3,]), y1=unlist(EYx.mauke92kids2y[4,]), col=cols[2],lwd=2,length=0.07,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5,9.5),unlist(EYx.mauke92kids2y[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add Bonferroni-corrected p-values (multiplied by 5 for 5 tests)#
	ptext <- ifelse(unlist(diff.maukekids2y[5,])*5<0.001,"p < 0.001",paste("p =",sprintf("%1.3f",unlist(diff.maukekids2y[5,])*5)))#
	mtext(ptext,side=1,line=0,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)#
dev.off()
table(a7592$agecat2,a7592$mda)
table(a7592$agecat,a7592$mda)
mean(table(a7592$agecat,a7592$mda))
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)
# Panel B age category beeswarm plot and E(Y_x)#
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)
arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)
tapply(log10(a7592$wb123+1),list(a7592$agecat,a7592$mda),function(x) mean(x,na.rm=T))
EYx.mauke75kids[1,]
EYx.mauke92kids[1,]
tapply(log10(a7592$wb123+1),list(a7592$agecat,a7592$mda),function(x) median(x,na.rm=T))
bxplot(wb123~agecat+mda,data=a7592,probs=0.5, col="gray40", add = TRUE)
bxplot(wb123~mda+agecat,data=a7592,probs=0.5, col="gray40", add = TRUE)
bxplot(wb123~mda+agecat2,data=a7592,probs=0.5, col="gray40", add = TRUE)
bxplot(log10(wb123+1)~mda+agecat2,data=a7592,probs=0.5, col="gray40", add = TRUE)
bxplot(log10(wb123+1)~mda+agecat,data=a7592,probs=0.5, col="gray40", add = TRUE)
op <- par(mar=c(5,5,3,0)+0.1)#
set.seed(34532) # set seed for exact reprodution of beeswarm display#
midpts <- beeswarm(log10(wb123)~mda+agecat,data=a7592,#
	log=FALSE,#
	labels=NA,#
	col=alpha(cols[1:2],alpha=0.5),#
	pch=16,#
	ylab="",yaxt="n",ylim=range(ytics),#
	xlab="",#
	bty="n"#
	)#
	axis(side=2,at=ytics,labels=c(#
		expression(10^2),#
		expression(10^3),#
		expression(10^4),#
		expression(10^5),#
		expression(10^6)#
		), las=1,cex.axis=1.5#
	)#
	# X labels and line segments#
	mtext(levels(a7592$agecat),side=1,line=1,at=c(1.5,3.5,5.5,7.5),cex=1.5)#
	segments(x0=c(2.5,4.5,6.5),y0=min(ytics),y1=max(ytics),col="gray60",lwd=1.5)#
	mtext("Age Category, Years",side=1,line=3,cex=1.5)#
	# Y label#
	mtext("B",line=1,at=-0.5,adj=0,font=2,cex=2)#
	mtext(expression(paste(italic(E),"(",italic(Y[x]),") stratified by child age")),line=1,cex=1.5)#
	mtext(c("1975","1992"),at=c(1,2),col=cols[1:2],side=3,line=-0.5)#
#
	# add in geometric means#
	# segments(x0=c(1,3,5,7)-0.2,x1=c(1,3,5,7)+0.2,y0=unlist(EYx.mauke75kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(2,4,6,8)-0.2,x1=c(2,4,6,8)+0.2,y0=unlist(EYx.mauke92kids[1,]),col="gray40",lwd=4)#
	# segments(x0=c(1,3,5,7),y0=unlist(EYx.mauke75kids[3,]),y1=unlist(EYx.mauke75kids[4,]),col="gray40",lwd=2)#
	# points(c(1,3,5,7),unlist(EYx.mauke75kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	# segments(x0=c(2,4,6,8),y0=unlist(EYx.mauke92kids[3,]),y1=unlist(EYx.mauke92kids[4,]),col="gray40",lwd=2)#
	# points(c(2,4,6,8),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col="gray40",lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke75kids[3,]), y1=unlist(EYx.mauke75kids[4,]), col=cols[1],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke75kids[1,]),pch=16,cex=1.75,bg="white",col=cols[1],lwd=2)#
	arrows(x0=c(1.5,3.5,5.5,7.5), y0=unlist(EYx.mauke92kids[3,]), y1=unlist(EYx.mauke92kids[4,]), col=cols[2],lwd=2,length=0.05,angle=90,code=3)#
	points(c(1.5,3.5,5.5,7.5),unlist(EYx.mauke92kids[1,]),pch=21,cex=1.75,bg="white",col=cols[2],lwd=2)#
#
	bxplot(log10(wb123+1)~mda+agecat,data=a7592,probs=0.5, col="gray40", add = TRUE)#
#
	# add pvalues#
	# mtext(paste("p =",sprintf("%1.3f",w.p)),side=1,line=-0.5,col="gray20",at=c(1.5,3.5,5.5,7.5,9.5),cex=0.8)#
#
par(op)
library(SuperLearner)
?SuperLearner
listWrappers()
